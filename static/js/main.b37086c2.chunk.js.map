{"version":3,"sources":["ImageGallery/ImageGalleryItem/ImageGalleryItem.module.css","Modal/Modal.module.css","ImageGallery/ImageGallery.module.css","Button/Button.module.css","getPics.ts","SearchBar/SearchBar.tsx","ImageGallery/ImageGalleryItem/ImageGalleryItem.tsx","ImageGallery/ImageGallery.tsx","Button/Button.tsx","Modal/Modal.tsx","App.tsx","index.js","SearchBar/SearchBar.module.css"],"names":["module","exports","config","pixabay","orientation","per_page","key","getPics","query","a","page","fetch","f","ok","Error","status","statusText","json","data","SearchBar","state","value","handleChange","e","setState","currentTarget","handleSubmit","preventDefault","props","onSubmit","className","css","SearchForm","this","type","SearchFormButton","SearchFormButtonLabel","SearchFormInput","autoComplete","autoFocus","placeholder","onChange","Component","ImageGalleryItem","p","index","src","previewURL","alt","tags","width","previewWidth","height","previewHeight","ImageGalleryItemImage","ImageGallery","hits","onClick","map","picData","i","Button","Modal","loading","img","div","handleClick","target","onClose","onImageLoad","closest","largeImageURL","Overlay","color","onLoad","hidden","scrollX","clientWidth","scrollY","clientHeight","scrollTo","left","top","App","total","totalHits","pageCount","modalIndex","allowScroll","Math","ceil","handleError","handleGalleryClick","li","Number","dataset","handleLoadMore","currentState","push","handleModalClose","document","addEventListener","code","error","alert","message","prev","window","documentElement","scrollHeight","behavior","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.b37086c2.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"ImageGalleryItem\":\"ImageGalleryItem_ImageGalleryItem__3Kfe1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Overlay\":\"Modal_Overlay__2O0_y\",\"Modal\":\"Modal_Modal__2AKIV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ImageGallery\":\"ImageGallery_ImageGallery__GO5-x\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Button\":\"Button_Button__1huuI\"};","import config from \"./config.json\";\r\n\r\nexport interface PicData {\r\n  collections: number;\r\n  comments: number;\r\n  downloads: number;\r\n  id: number;\r\n  imageHeight: number;\r\n  imageSize: number;\r\n  imageWidth: number;\r\n  largeImageURL: string;\r\n  likes: number;\r\n  pageURL: string;\r\n  previewHeight: number;\r\n  previewURL: string;\r\n  previewWidth: number;\r\n  tags: string;\r\n  type: string;\r\n  user: string;\r\n  userImageURL: string;\r\n  user_id: number;\r\n  views: number;\r\n  webformatHeight: number;\r\n  webformatURL: string;\r\n  webformatWidth: number;\r\n}\r\n\r\nexport interface PixResponse {\r\n  total: number;\r\n  totalHits: number;\r\n  hits: Array<PicData>;\r\n}\r\n\r\nconst { orientation, per_page, key } = config.pixabay;\r\n\r\nexport default async function getPics(\r\n  query: string,\r\n  page = 1\r\n): Promise<PixResponse> {\r\n  const f = await fetch(\r\n    `https://pixabay.com/api/?image_type=photo&orientation=${orientation}&q=${query}&page=${page}&per_page=${per_page}&key=${key}`\r\n  );\r\n  if (!f.ok) throw new Error(`Error ${f.status}: ${f.statusText}`);\r\n  const data = await f.json();\r\n  return data;\r\n}\r\n","import { Component, ChangeEventHandler, FormEventHandler } from \"react\";\r\nimport css from \"./SearchBar.module.css\";\r\n\r\nclass SearchBar extends Component<{ onSubmit: (value: string) => void }> {\r\n  state = { value: \"\" };\r\n  handleChange: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n    this.setState({ value: e.currentTarget.value });\r\n  };\r\n\r\n  handleSubmit: FormEventHandler = (e) => {\r\n    e.preventDefault();\r\n    this.props.onSubmit(this.state.value);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <header className={css.SearchBar}>\r\n        <form className={css.SearchForm} onSubmit={this.handleSubmit}>\r\n          <button type=\"submit\" className={css.SearchFormButton}>\r\n            <span className={css.SearchFormButtonLabel}>üîç</span>\r\n          </button>\r\n\r\n          <input\r\n            className={css.SearchFormInput}\r\n            type=\"text\"\r\n            autoComplete=\"off\"\r\n            autoFocus\r\n            placeholder=\"Search images and photos\"\r\n            value={this.state.value}\r\n            onChange={this.handleChange}\r\n          />\r\n        </form>\r\n      </header>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SearchBar;\r\n","import { PicData } from \"../../getPics\";\r\nimport css from \"./ImageGalleryItem.module.css\";\r\n\r\ninterface GalleryItemData extends PicData {\r\n  index: number;\r\n}\r\n\r\nconst ImageGalleryItem = (p: GalleryItemData) => {\r\n  return (\r\n    <li className={css.ImageGalleryItem} data-index={p.index}>\r\n      <img\r\n        src={p.previewURL}\r\n        alt={p.tags}\r\n        width={p.previewWidth}\r\n        height={p.previewHeight}\r\n        className={css.ImageGalleryItemImage}\r\n      />\r\n    </li>\r\n  );\r\n};\r\n\r\nexport default ImageGalleryItem;\r\n","import { MouseEventHandler } from \"react\";\r\nimport { AppState } from \"../App\";\r\nimport ImageGalleryItem from \"./ImageGalleryItem/ImageGalleryItem\";\r\nimport css from \"./ImageGallery.module.css\";\r\n\r\ninterface GalleryData extends AppState {\r\n  onClick: MouseEventHandler;\r\n}\r\n\r\nconst ImageGallery = ({ hits, onClick }: GalleryData) => {\r\n  return (\r\n    <ul className={css.ImageGallery} onClick={onClick}>\r\n      {hits.map((picData, i) => (\r\n        <ImageGalleryItem {...picData} index={i} key={i} />\r\n      ))}\r\n    </ul>\r\n  );\r\n};\r\n\r\nexport default ImageGallery;\r\n","import css from \"./Button.module.css\";\r\n\r\nconst Button = ({ onClick }: { onClick: () => void }) => {\r\n  return (\r\n    <button type=\"button\" onClick={onClick} className={css.Button}>\r\n      Load More\r\n    </button>\r\n  );\r\n};\r\n\r\nexport default Button;\r\n","import { Component, MouseEventHandler, ReactEventHandler } from \"react\";\r\nimport Loader from \"react-loader-spinner\";\r\nimport { PicData } from \"../getPics\";\r\nimport css from \"./Modal.module.css\";\r\n\r\ninterface ModalData extends PicData {\r\n  onClose: () => void;\r\n}\r\n\r\nclass Modal extends Component<ModalData> {\r\n  state = { loading: true };\r\n  img: HTMLImageElement | null = null;\r\n  div: HTMLDivElement | null = null;\r\n  handleClick: MouseEventHandler = (e) => {\r\n    if (e.currentTarget !== e.target) return;\r\n    this.props.onClose();\r\n  };\r\n  onImageLoad: ReactEventHandler<HTMLImageElement> = (e) => {\r\n    this.img = e.currentTarget;\r\n    this.div = this.img.closest(\"div\");\r\n    this.setState({ loading: false });\r\n  };\r\n  render() {\r\n    const { largeImageURL, tags } = this.props;\r\n    return (\r\n      <div className={css.Overlay} onClick={this.handleClick}>\r\n        <div className={css.Modal}>\r\n          {this.state.loading && (\r\n            <Loader type=\"Oval\" color=\"#ffffff\" width=\"100px\" height=\"100px\" />\r\n          )}\r\n          <img\r\n            src={largeImageURL}\r\n            alt={tags}\r\n            onLoad={this.onImageLoad}\r\n            hidden={this.state.loading}\r\n          />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n  componentDidUpdate() {\r\n    if (!this.div || !this.img) return;\r\n    const scrollX = (this.img.clientWidth - this.div.clientWidth) / 2;\r\n    const scrollY = (this.img.clientHeight - this.div.clientHeight) / 2;\r\n    this.div.scrollTo({\r\n      left: scrollX > 0 ? scrollX : 0,\r\n      top: scrollY > 0 ? scrollY : 0,\r\n    });\r\n  }\r\n}\r\n\r\nexport default Modal;\r\n","import { Component, MouseEventHandler } from \"react\";\nimport Loader from \"react-loader-spinner\";\nimport getPics, { PicData, PixResponse } from \"./getPics\";\nimport { pixabay } from \"./config.json\";\n\nimport SearchBar from \"./SearchBar/SearchBar\";\nimport ImageGallery from \"./ImageGallery/ImageGallery\";\nimport Button from \"./Button/Button\";\nimport Modal from \"./Modal/Modal\";\n\nexport interface AppState extends PixResponse {\n  query: string;\n  page: number;\n  pageCount: number;\n  loading: boolean;\n  modalIndex: number;\n}\n\nclass App extends Component<{}, AppState> {\n  state = {\n    total: 0,\n    totalHits: 0,\n    hits: [] as PicData[],\n    query: \"\",\n    page: 1,\n    pageCount: 1,\n    loading: false,\n    modalIndex: -1,\n  };\n  allowScroll = true;\n\n  componentDidMount() {\n    document.addEventListener(\"keydown\", (e) => {\n      if (this.state.modalIndex < 0) return;\n      if (e.code === \"Escape\") this.setState({ modalIndex: -1 });\n    });\n  }\n\n  handleSubmit = async (value: string) => {\n    try {\n      this.setState({ loading: true });\n      const data = (await getPics(value)) as AppState;\n      data.query = value;\n      data.page = 1;\n      data.pageCount = Math.ceil(data.total / pixabay.per_page);\n      data.loading = false;\n      this.setState(data);\n    } catch (error) {\n      this.handleError(error as Error);\n    }\n  };\n\n  handleGalleryClick: MouseEventHandler = (e) => {\n    const li = (e.target as HTMLElement).closest(\"li\");\n    if (!li) return;\n    this.allowScroll = false;\n    this.setState({ modalIndex: Number(li.dataset.index) });\n  };\n\n  handleLoadMore = async () => {\n    try {\n      const currentState = this.state;\n      this.setState({ loading: true });\n      const data = (await getPics(\n        currentState.query,\n        ++currentState.page\n      )) as AppState;\n      currentState.hits.push(...data.hits);\n      currentState.loading = false;\n      this.setState(currentState);\n    } catch (error) {\n      this.handleError(error as Error);\n    }\n  };\n\n  handleModalClose = () => {\n    this.allowScroll = false;\n    this.setState({ modalIndex: -1 });\n  };\n\n  handleError(error: Error) {\n    alert(error.message);\n    this.setState((prev) => ({ loading: false, pageCount: prev.page }));\n  }\n\n  componentDidUpdate() {\n    if (!this.allowScroll) {\n      this.allowScroll = true;\n      return;\n    }\n    window.scrollTo({\n      top: document.documentElement.scrollHeight,\n      behavior: \"smooth\",\n    });\n  }\n\n  render() {\n    return (\n      <>\n        <SearchBar onSubmit={this.handleSubmit} />\n        <ImageGallery {...this.state} onClick={this.handleGalleryClick} />\n        {this.state.loading && (\n          <Loader type=\"Oval\" color=\"#4354b0\" width=\"50px\" height=\"50px\" />\n        )}\n        {this.state.page < this.state.pageCount && (\n          <Button onClick={this.handleLoadMore} />\n        )}\n        {this.state.modalIndex > -1 && (\n          <Modal\n            {...this.state.hits[this.state.modalIndex]}\n            onClose={this.handleModalClose}\n          />\n        )}\n      </>\n    );\n  }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"SearchBar\":\"SearchBar_SearchBar__1KZPC\",\"SearchForm\":\"SearchBar_SearchForm__1meme\",\"SearchFormButton\":\"SearchBar_SearchFormButton__2ANbg\",\"SearchFormInput\":\"SearchBar_SearchFormInput__2tuir\"};"],"sourceRoot":""}